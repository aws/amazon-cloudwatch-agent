// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: MIT

package cloudwatch

type SupportUnit map[string]struct{}

// CloudWatch supports:
// https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_MetricDatum.html
var supportedUnits = map[string]struct{}{
	"Seconds":          {},
	"Microseconds":     {},
	"Milliseconds":     {},
	"Bytes":            {},
	"Kilobytes":        {},
	"Megabytes":        {},
	"Gigabytes":        {},
	"Terabytes":        {},
	"Bits":             {},
	"Kilobits":         {},
	"Megabits":         {},
	"Gigabits":         {},
	"Terabits":         {},
	"Percent":          {},
	"Count":            {},
	"Bytes/Second":     {},
	"Kilobytes/Second": {},
	"Megabytes/Second": {},
	"Gigabytes/Second": {},
	"Terabytes/Second": {},
	"Bits/Second":      {},
	"Kilobits/Second":  {},
	"Megabits/Second":  {},
	"Gigabits/Second":  {},
	"Terabits/Second":  {},
	"Count/Second":     {},
	"None":             {},
}

type MetricDefaultUnit map[string]string

var metricDefaultUnit = MetricDefaultUnit{
	"procstat_read_bytes":                   "Bytes",
	"procstat_read_count":                   "Count",
	"procstat_write_bytes":                  "Bytes",
	"procstat_write_count":                  "Count",
	"procstat_memory_data":                  "Bytes",
	"procstat_memory_locked":                "Bytes",
	"procstat_memory_rss":                   "Bytes",
	"procstat_memory_stack":                 "Bytes",
	"procstat_memory_swap":                  "Bytes",
	"procstat_memory_vms":                   "Bytes",
	"procstat_cpu_usage":                    "Percent",
	"procstat_cpu_time":                     "Count",
	"procstat_cpu_time_user":                "Count",
	"procstat_cpu_time_guest":               "Count",
	"procstat_cpu_time_guest_nice":          "Count",
	"procstat_cpu_time_idle":                "Count",
	"procstat_cpu_time_iowait":              "Count",
	"procstat_cpu_time_irq":                 "Count",
	"procstat_cpu_time_soft_irq":            "Count",
	"procstat_cpu_time_nice":                "Count",
	"procstat_cpu_time_steal":               "Count",
	"procstat_cpu_time_stolen":              "Count",
	"procstat_rlimit_cpu_time_hard":         "Count",
	"procstat_rlimit_cpu_time_soft":         "Count",
	"procstat_rlimit_file_locks_hard":       "Count",
	"procstat_rlimit_file_locks_soft":       "Count",
	"procstat_rlimit_memory_data_hard":      "Bytes",
	"procstat_rlimit_memory_data_soft":      "Bytes",
	"procstat_rlimit_memory_locked_hard":    "Bytes",
	"procstat_rlimit_memory_locked_soft":    "Bytes",
	"procstat_rlimit_memory_rss_hard":       "Bytes",
	"procstat_rlimit_memory_rss_soft":       "Bytes",
	"procstat_rlimit_memory_stack_hard":     "Bytes",
	"procstat_rlimit_memory_stack_soft":     "Bytes",
	"procstat_rlimit_memory_vms_hard":       "Bytes",
	"procstat_rlimit_memory_vms_soft":       "Bytes",
	"procstat_pid":                          "Count",
	"procstat_pid_count":                    "Count",
	"procstat_nice_priority":                "Count",
	"procstat_realtime_priority":            "Count",
	"procstat_signals_pending":              "Count",
	"procstat_voluntary_context_switches":   "Count",
	"procstat_involuntary_context_switches": "Count",

	"cpu_usage_active":     "Percent",
	"cpu_usage_idle":       "Percent",
	"cpu_usage_nice":       "Percent",
	"cpu_usage_guest":      "Percent",
	"cpu_usage_guest_nice": "Percent",
	"cpu_usage_iowait":     "Percent",
	"cpu_usage_irq":        "Percent",
	"cpu_usage_softirq":    "Percent",
	"cpu_usage_steal":      "Percent",
	"cpu_usage_system":     "Percent",
	"cpu_usage_user":       "Percent",

	"disk_free":         "Bytes",
	"disk_total":        "Bytes",
	"disk_used":         "Bytes",
	"disk_inodes_free":  "Count",
	"disk_inodes_total": "Count",
	"disk_inodes_used":  "Count",
	"disk_used_percent": "Percent",

	"diskio_iops_in_progress": "Count",
	"diskio_io_time":          "Milliseconds",
	"diskio_reads":            "Count",
	"diskio_writes":           "Count",
	"diskio_read_bytes":       "Bytes",
	"diskio_write_bytes":      "Bytes",
	"diskio_read_time":        "Milliseconds",
	"diskio_write_time":       "Milliseconds",

	"swap_used":         "Bytes",
	"swap_total":        "Bytes",
	"swap_used_percent": "Percent",
	"swap_free":         "Bytes",

	"mem_used":              "Bytes",
	"mem_cached":            "Bytes",
	"mem_total":             "Bytes",
	"mem_available":         "Bytes",
	"mem_free":              "Bytes",
	"mem_buffered":          "Bytes",
	"mem_active":            "Bytes",
	"mem_inactive":          "Bytes",
	"mem_available_percent": "Percent",
	"mem_used_percent":      "Percent",

	"net_bytes_sent":   "Bytes",
	"net_bytes_recv":   "Bytes",
	"net_drop_in":      "Count",
	"net_drop_out":     "Count",
	"net_err_in":       "Count",
	"net_err_out":      "Count",
	"net_packets_sent": "Count",
	"net_packets_recv": "Count",

	"netstat_tcp_established": "Count",
	"netstat_tcp_syn_sent":    "Count",
	"netstat_tcp_syn_recv":    "Count",
	"netstat_tcp_close":       "Count",
	"netstat_tcp_close_wait":  "Count",
	"netstat_tcp_closing":     "Count",
	"netstat_tcp_fin_wait1":   "Count",
	"netstat_tcp_fin_wait2":   "Count",
	"netstat_tcp_last_ack":    "Count",
	"netstat_tcp_listen":      "Count",
	"netstat_tcp_none":        "Count",
	"netstat_tcp_time_wait":   "Count",
	"netstat_udp_socket":      "Count",

	"processes_blocked":       "Count",
	"processes_idle":          "Count",
	"processes_paging":        "Count",
	"processes_stopped":       "Count",
	"processes_total":         "Count",
	"processes_total_threads": "Count",
	"processes_wait":          "Count",
	"processes_zombie":        "Count",
	"processes_running":       "Count",
	"processes_sleeping":      "Count",
	"processes_dead":          "Count",
}

func isUnitInvalid(unit string) bool {
	if unit == "" {
		return false
	}
	_, ok := supportedUnits[unit]
	return !ok
}
